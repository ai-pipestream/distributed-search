version: '3.8'

services:
  coordinator:
    build: 
      context: ./coordinator
      dockerfile: src/main/docker/Dockerfile.jvm
    ports:
      - "8080:8080"
    environment:
      - QUARKUS_GRPC_CLIENTS_SHARD_NODE_HOST=shard-0
      - QUARKUS_GRPC_CLIENTS_SHARD_NODE_PORT=9000

  shard-0:
    build:
      context: ./shard-node
      dockerfile: src/main/docker/Dockerfile.jvm
    environment:
      - KNN_INDEX_PATH=/data/shard-0
      - KNN_SHARD_ID=0
    volumes:
      - ./shards/shard-0:/data/shard-0

  # Repeat for shard-1..7 in a real setup
